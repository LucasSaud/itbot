
/** 
* This file has been protected.
*/
   
const _0x579fff=_0x9f20;(function(_0x317c6c,_0x40fe94){const _0x3be8f2=_0x9f20,_0x14d62f=_0x317c6c();while(!![]){try{const _0x502185=-parseInt(_0x3be8f2(0x187))/0x1+parseInt(_0x3be8f2(0x154))/0x2+parseInt(_0x3be8f2(0x176))/0x3*(parseInt(_0x3be8f2(0x151))/0x4)+parseInt(_0x3be8f2(0x15c))/0x5+-parseInt(_0x3be8f2(0x148))/0x6*(parseInt(_0x3be8f2(0x122))/0x7)+parseInt(_0x3be8f2(0x15b))/0x8+parseInt(_0x3be8f2(0x123))/0x9;if(_0x502185===_0x40fe94)break;else _0x14d62f['push'](_0x14d62f['shift']());}catch(_0x5be881){_0x14d62f['push'](_0x14d62f['shift']());}}}(_0x3e36,0xb89e9));function _0x3e36(){const _0x1b65e1=['Mensagens\x20processadas\x20por\x20dia','getDay','238NQsALZ','10648206KWQsLt','cGraph','sql04','sql03','rgba(75,\x20192,\x20192,\x200.7)','rgba(153,\x20102,\x20255,\x200.7)','Taxa\x20de\x20Conversão\x20de\x20Clientes:\x20','month','./utils','setDate','length','toBuffer','body','Cardápio','Média','path','ASC','DATE','setHeight','*Taxa\x20de\x20Conversão\x20de\x20Clientes:\x20','#000','orange','bold','dataValues','horizontal','showLog','sql01a','Opções\x20de\x20Consumo/Entrega','join','Horários\x20de\x20Funcionamento','log','reduce','point','toFile','findAll','COUNT','getMonth','201486YbWaQk','error','name','Tempo\x20para\x20Entregar','date','Opções\x20de\x20Pagamento','toISOString','DATE_FORMAT','dir','71892ewyjvY','diasSemana','quickchart-js','1086518mgEVSK','count','sender','Resultado\x20da\x20consulta\x20em\x20sql02:','Message','red','Conversão','1835200jXaTEg','4830110GeCIyB','doughnut','Erro\x20ao\x20contar\x20mensagens\x20recebidas\x20por\x20dia:','regexp','between','label','Nenhum\x20dado\x20retornado\x20pela\x20consulta\x20de\x20atendimentos\x20mensais.','top','DISTINCT','version','toFixed','setConfig','floor','afterDraw','getDate','.png','sql01','Conversão:','map','sendImage','Contacts','charts','Erro\x20ao\x20criar\x20o\x20gráfico:','setWidth','random','timestamp','69IGKCbb','images','yellow','getFullYear','dGraph','Falar\x20com\x20um\x20Atendente','Alta','Baixa','sql02','(SELECT\x20DISTINCT\x20sender\x20FROM\x20messages\x20WHERE\x20body\x20=\x20\x275\x27)','green','sequelize','setVersion','bar','getGradientFillHelper','^[1-8]$','rgba(255,\x20159,\x2064,\x200.7)','1437239jTBBoz','rgba(255,\x2099,\x20132,\x200.7)','Utilização\x20dos\x20comandos','col','Atendimentos\x20por\x20dia','Fazer\x20um\x20Pedido'];_0x3e36=function(){return _0x1b65e1;};return _0x3e36();}const fs=require('fs'),util=require('util'),path=require(_0x579fff(0x132)),{Sequelize,DataTypes,Op}=require(_0x579fff(0x181)),QuickChart=require(_0x579fff(0x153)),config=require('../conf/config.js'),utils=require(_0x579fff(0x12b)),currentMonth=()=>{const _0x8c2f1c=_0x579fff,_0x4f6f9a=new Date();return _0x4f6f9a[_0x8c2f1c(0x147)]()+0x1;},nextMonth=()=>{return currentMonth()+0x1;},startDate=currentMonth(),endDate=nextMonth();class Chart{constructor(){const _0x4c6436=_0x579fff;this[_0x4c6436(0x165)]='1.0.1';}async[_0x579fff(0x16c)](_0x3f69dc,_0x57b693,_0x1f0f24,_0x1e35bc=![],_0x156cd6=![]){const _0x2f5212=_0x579fff,_0x43d39b=await _0x1f0f24[_0x2f5212(0x158)][_0x2f5212(0x155)]({'where':{'body':'5'}}),_0x4e3cb4=await _0x1f0f24[_0x2f5212(0x170)]['count']({'where':{'whatsappNumber':{[Sequelize['Op']['in']]:Sequelize['literal'](_0x2f5212(0x17f))}}}),_0x5d34c7=_0x4e3cb4/_0x43d39b*0x64;return this[_0x2f5212(0x124)](_0x3f69dc,_0x57b693,_0x5d34c7[_0x2f5212(0x166)](0x2),_0x1e35bc,_0x156cd6);}async[_0x579fff(0x13d)](_0x2ed361,_0x5d9fd3,_0x599e68,_0x383835=![],_0x442dc8=![]){const _0x25114e=_0x579fff,_0x2994b1=new Date(),_0x2e7b1e=new Date(_0x2994b1[_0x25114e(0x179)](),startDate,0x1),_0x30b1f=new Date(_0x2994b1['getFullYear'](),endDate,0x0),_0x489d77=await _0x599e68['Message'][_0x25114e(0x155)]({'where':{'body':'5','timestamp':{[Sequelize['Op'][_0x25114e(0x160)]]:[_0x2e7b1e,_0x30b1f]}}}),_0x30cfb1=await _0x599e68[_0x25114e(0x170)][_0x25114e(0x155)]({'where':{'whatsappNumber':{[Op['in']]:[Sequelize['literal']('SELECT\x20DISTINCT\x20sender\x20FROM\x20messages\x20WHERE\x20body\x20=\x20\x275\x27\x20AND\x20timestamp\x20BETWEEN\x20\x27'+_0x2e7b1e[_0x25114e(0x14e)]()+'\x27\x20AND\x20\x27'+_0x30b1f[_0x25114e(0x14e)]()+'\x27')]}}}),_0x285196=_0x30cfb1/_0x489d77*0x64;return this[_0x25114e(0x124)](_0x2ed361,_0x5d9fd3,_0x285196['toFixed'](0x2),_0x383835,_0x442dc8);}async[_0x579fff(0x17e)](_0xf7bb98,_0x3139d9,_0x1c0f2a,_0x33dbe1=![],_0x863786=![]){const _0x10ed9c=_0x579fff;try{const _0x4bd12c=new Date(),_0x5a2e93=new Date();_0x5a2e93['setDate'](_0x4bd12c[_0x10ed9c(0x16a)]()-0x6);const _0x29b9d8=await _0x1c0f2a[_0x10ed9c(0x158)][_0x10ed9c(0x145)]({'attributes':[[_0x1c0f2a[_0x10ed9c(0x181)]['fn'](_0x10ed9c(0x14c),_0x1c0f2a[_0x10ed9c(0x181)][_0x10ed9c(0x11d)](_0x10ed9c(0x175))),_0x10ed9c(0x14c)],[_0x1c0f2a[_0x10ed9c(0x181)]['fn'](_0x10ed9c(0x155),_0x1c0f2a[_0x10ed9c(0x181)]['col']('*')),_0x10ed9c(0x155)]],'where':{'timestamp':{[Sequelize['Op'][_0x10ed9c(0x160)]]:[_0x5a2e93,_0x4bd12c]}},'group':['date'],'order':[[_0x10ed9c(0x14c),_0x10ed9c(0x133)]]});if(config[_0x10ed9c(0x13c)]===!![])console[_0x10ed9c(0x141)](_0x10ed9c(0x157),_0x29b9d8);if(_0x29b9d8&&_0x29b9d8[_0x10ed9c(0x12d)]>0x0){const _0x572db4=_0x29b9d8[_0x10ed9c(0x16e)](_0x1f5249=>({'name':config[_0x10ed9c(0x152)][new Date(_0x1f5249[_0x10ed9c(0x13a)]['date'])[_0x10ed9c(0x121)]()],'count':parseInt(_0x1f5249[_0x10ed9c(0x13a)]['count'])}));this[_0x10ed9c(0x17a)](_0xf7bb98,_0x3139d9,_0x572db4,_0x10ed9c(0x120),_0x33dbe1,_0x863786);}else console['log']('A\x20consulta\x20não\x20retornou\x20resultados.');}catch(_0x2e9426){console[_0x10ed9c(0x149)](_0x10ed9c(0x15e),_0x2e9426);}}async[_0x579fff(0x126)](_0x3ef2c8,_0x256bd8,_0x2b764f,_0x5bcf6d=![],_0x552d57=![]){const _0x3ee34d=_0x579fff,_0x267831=new Date(),_0x3ede6b=new Date();_0x3ede6b[_0x3ee34d(0x12c)](_0x267831[_0x3ee34d(0x16a)]()-0x6);const _0x5efe18=await _0x2b764f['Message'][_0x3ee34d(0x145)]({'attributes':[[_0x2b764f['sequelize']['fn']('DATE',_0x2b764f[_0x3ee34d(0x181)][_0x3ee34d(0x11d)](_0x3ee34d(0x175))),_0x3ee34d(0x14c)],[_0x2b764f[_0x3ee34d(0x181)]['fn'](_0x3ee34d(0x146),_0x2b764f[_0x3ee34d(0x181)]['fn'](_0x3ee34d(0x164),_0x2b764f[_0x3ee34d(0x181)]['col']('sender'))),'count']],'where':{'timestamp':{[Sequelize['Op'][_0x3ee34d(0x160)]]:[_0x3ede6b,_0x267831]}},'group':[_0x2b764f[_0x3ee34d(0x181)]['fn'](_0x3ee34d(0x134),_0x2b764f[_0x3ee34d(0x181)]['col'](_0x3ee34d(0x175)))],'raw':!![]});let _0x89ae91=null;const _0x6dfa3f=_0x5efe18[_0x3ee34d(0x16e)](_0x2285b9=>({'name':config['diasSemana'][new Date(_0x2285b9['date'])[_0x3ee34d(0x121)]()],'count':_0x2285b9[_0x3ee34d(0x155)]}));this['dGraph'](_0x3ef2c8,_0x256bd8,_0x6dfa3f,_0x3ee34d(0x11e),_0x5bcf6d,_0x552d57);}async[_0x579fff(0x125)](_0x34d207,_0x2bba02,_0x34fb76,_0x57020b=![],_0x1b92d4=![]){const _0x313f8f=_0x579fff,_0x14d6b3=await _0x34fb76[_0x313f8f(0x158)][_0x313f8f(0x145)]({'attributes':['body',[_0x34fb76['sequelize']['fn'](_0x313f8f(0x146),_0x34fb76[_0x313f8f(0x181)][_0x313f8f(0x11d)](_0x313f8f(0x12f))),_0x313f8f(0x155)]],'where':{'body':{[Sequelize['Op'][_0x313f8f(0x15f)]]:_0x313f8f(0x185)}},'group':_0x313f8f(0x12f),'raw':!![]}),_0x318b9b={0x1:_0x313f8f(0x140),0x2:_0x313f8f(0x130),0x3:'Nossa\x20Localização',0x4:_0x313f8f(0x14b),0x5:_0x313f8f(0x11f),0x6:_0x313f8f(0x14d),0x7:_0x313f8f(0x13e),0x8:_0x313f8f(0x17b)};let _0x4053fc=null;const _0x3f9f64=_0x14d6b3['map'](_0x57a5f8=>({'name':_0x318b9b[_0x57a5f8[_0x313f8f(0x12f)]],'count':_0x57a5f8[_0x313f8f(0x155)]}));this[_0x313f8f(0x17a)](_0x34d207,_0x2bba02,_0x3f9f64,_0x313f8f(0x189),_0x57020b,_0x1b92d4);}async['sql05'](_0x2c2b5e,_0x21918d,_0x5070ab,_0xc02bf1=![],_0x1262f6=![]){const _0xd7e060=_0x579fff,_0x43021a=await _0x5070ab[_0xd7e060(0x158)][_0xd7e060(0x145)]({'attributes':[[_0x5070ab[_0xd7e060(0x181)]['fn'](_0xd7e060(0x14f),_0x5070ab['sequelize'][_0xd7e060(0x11d)]('timestamp'),'%M'),_0xd7e060(0x12a)],[_0x5070ab[_0xd7e060(0x181)]['fn'](_0xd7e060(0x146),_0x5070ab['sequelize']['fn'](_0xd7e060(0x164),_0x5070ab[_0xd7e060(0x181)][_0xd7e060(0x11d)](_0xd7e060(0x156)))),_0xd7e060(0x155)]],'group':[_0x5070ab['sequelize']['fn'](_0xd7e060(0x14f),_0x5070ab['sequelize'][_0xd7e060(0x11d)]('timestamp'),'%M')],'raw':!![]});if(_0x43021a[_0xd7e060(0x12d)]>0x0){const _0x151e54=_0x43021a[_0xd7e060(0x16e)](_0x1ec6c0=>({'name':_0x1ec6c0['month'],'count':_0x1ec6c0[_0xd7e060(0x155)]}));this[_0xd7e060(0x17a)](_0x2c2b5e,_0x21918d,_0x151e54,'Atendimentos\x20por\x20Mês',_0xc02bf1,_0x1262f6);}else console[_0xd7e060(0x149)](_0xd7e060(0x162));}async['dGraph'](_0x181d39,_0x4c7c15,_0x11733e,_0xd0bafa,_0x4fd0b2=![],_0x1c460e=![]){const _0x2535d4=_0x579fff;let _0x16282c=Math[_0x2535d4(0x168)](Math[_0x2535d4(0x174)]()*(0x270f-0x3e8+0x1))+0x3e8;const _0x396122=_0x11733e['map'](_0x1c7af3=>_0x1c7af3[_0x2535d4(0x14a)]),_0x115ab0=_0x11733e['map'](_0x1d74f3=>_0x1d74f3[_0x2535d4(0x155)]),_0x15141a=_0x115ab0[_0x2535d4(0x142)]((_0x34f620,_0x2e12d1)=>_0x34f620+_0x2e12d1,0x0),_0x417746=new QuickChart();_0x417746[_0x2535d4(0x167)]({'type':_0x2535d4(0x15d),'data':{'labels':_0x396122,'datasets':[{'data':_0x115ab0,'backgroundColor':[_0x2535d4(0x188),'rgba(54,\x20162,\x20235,\x200.7)','rgba(255,\x20206,\x2086,\x200.7)',_0x2535d4(0x127),_0x2535d4(0x128),_0x2535d4(0x186),'rgba(0,\x20128,\x200,\x200.7)']}]},'options':{'plugins':{'doughnutlabel':{'labels':[{'text':''+_0x15141a,'font':{'size':0x14,'weight':'bold'}},{'text':'Total'}]}},'legend':{'display':!![],'position':'left'},'title':{'display':!![],'text':_0xd0bafa,'font':{'size':0x16,'weight':_0x2535d4(0x139)},'position':_0x2535d4(0x163)}}})['setWidth'](0x258)[_0x2535d4(0x135)](0x190);try{const _0x1d17f7=path[_0x2535d4(0x13f)](__dirname,'..',config[_0x2535d4(0x150)][_0x2535d4(0x177)],config[_0x2535d4(0x150)][_0x2535d4(0x171)],_0x16282c+'.png'),_0x4e0bd0=await _0x417746[_0x2535d4(0x144)](_0x1d17f7);if(_0x1c460e===!![])return await _0x417746[_0x2535d4(0x12e)]();else{if(_0x4fd0b2===!![])return _0x1d17f7;else await _0x181d39['sendImage'](_0x4c7c15,_0x1d17f7,'*'+_0xd0bafa+'*');}if(config['showLog']===!![])console['log'](''+_0xd0bafa);}catch(_0x2dc972){console[_0x2535d4(0x149)](_0x2535d4(0x172),_0x2dc972);}}async['cGraph'](_0x44c760,_0x2a412c,_0x5380bb,_0x57c79d=![],_0x2923f6=![]){const _0x2a6c63=_0x579fff;let _0x4422fd=new QuickChart(),_0x15a90f=Math[_0x2a6c63(0x168)](Math['random']()*(0x270f-0x3e8+0x1))+0x3e8;_0x4422fd[_0x2a6c63(0x173)](0x1f4),_0x4422fd[_0x2a6c63(0x135)](0x96),_0x4422fd[_0x2a6c63(0x182)]('3'),_0x4422fd[_0x2a6c63(0x167)]({'type':_0x2a6c63(0x183),'data':{'labels':['Q1'],'datasets':[{'label':_0x2a6c63(0x15a),'data':[0x64],'backgroundColor':QuickChart[_0x2a6c63(0x184)](_0x2a6c63(0x13b),[_0x2a6c63(0x180),_0x2a6c63(0x178),_0x2a6c63(0x138),_0x2a6c63(0x159)])}]},'options':{'indexAxis':'y','layout':{'padding':0x28},'scales':{'x':{'display':![]},'y':{'display':![]}},'plugins':{'legend':{'display':![]},'annotation':{'clip':![],'common':{'drawTime':_0x2a6c63(0x169)},'annotations':{'low':{'type':_0x2a6c63(0x161),'xValue':0x4,'content':[_0x2a6c63(0x17d)],'font':{'size':0x12,'weight':_0x2a6c63(0x139)}},'medium':{'type':_0x2a6c63(0x161),'xValue':0x32,'content':[_0x2a6c63(0x131)],'font':{'size':0x12,'weight':_0x2a6c63(0x139)}},'high':{'type':_0x2a6c63(0x161),'xValue':0x5f,'content':[_0x2a6c63(0x17c)],'font':{'size':0x12,'weight':'bold'}},'arrow':{'type':_0x2a6c63(0x143),'pointStyle':'triangle','backgroundColor':_0x2a6c63(0x137),'radius':0xf,'xValue':_0x5380bb,'yAdjust':0x41},'label1':{'type':_0x2a6c63(0x161),'xValue':_0x5380bb,'yAdjust':0x5f,'content':[_0x2a6c63(0x16d),_0x5380bb+'%'],'font':{'size':0x12,'weight':_0x2a6c63(0x139)}}}}}}});try{const _0x52115c=path['join'](__dirname,'..',config[_0x2a6c63(0x150)][_0x2a6c63(0x177)],config[_0x2a6c63(0x150)][_0x2a6c63(0x171)],_0x15a90f+_0x2a6c63(0x16b)),_0x373d2b=await _0x4422fd['toFile'](_0x52115c);if(_0x2923f6===!![])return await _0x4422fd[_0x2a6c63(0x12e)]();else{if(_0x57c79d===!![])return _0x52115c;else await _0x44c760[_0x2a6c63(0x16f)](_0x2a412c,_0x52115c,_0x2a6c63(0x136)+_0x5380bb+'*');}if(config['showLog']===!![])console['log'](_0x2a6c63(0x129)+_0x5380bb);}catch(_0x939d4){console['error'](_0x2a6c63(0x172),_0x939d4);}}}function _0x9f20(_0x15d517,_0x2d501c){const _0x3e3691=_0x3e36();return _0x9f20=function(_0x9f2050,_0x1d6528){_0x9f2050=_0x9f2050-0x11d;let _0x50accb=_0x3e3691[_0x9f2050];return _0x50accb;},_0x9f20(_0x15d517,_0x2d501c);}module['exports']=Chart;
   